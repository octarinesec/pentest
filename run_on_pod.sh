#!/bin/bash

if [ "$1" == "" ]; then
    echo "Usage: $0 <pod-name>"
    exit
fi

pod_name=$(kubectl get pods | grep $1 | awk '{print $1}')

echo "Found pod: $pod_name!"
echo -n "Uploading pentest tool to pod... "
kubectl cp bin/linux/pentest $pod_name:/pentest
if [ $? -ne 0 ]; then
    echo Failed uploading to pod.
    exit $?
fi
echo "Done!"

echo "Running shell on pod. The tool located at /pentest"
kubectl exec -it $pod_name /bin/bash
