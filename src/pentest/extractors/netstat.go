package extractors

import (
	"fmt"
	"github.com/drael/GOnetstat"
	"os"
	"pentest/engine"
)

type NetstatExtractor struct {}

func (_ NetstatExtractor) Extract() {
	details := GOnetstat.Tcp()
	for _, process := range details {
		engine.AddIP(process.Ip)
		engine.AddPort(uint16(process.ForeignPort))
	}
}

func init() {
	fmt.Println("Adding NetstatExtractor Extractor")

	file, err := os.Open("/proc")
	if err != nil {
		return
	}
	file.Close()

	engine.AddExtractor(NetstatExtractor{})
}
