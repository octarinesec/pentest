package extractors

import (
	"github.com/drael/GOnetstat"
	log "github.com/sirupsen/logrus"
	"os"
	"pentest/engine"
)

type NetstatExtractor struct{}

func (NetstatExtractor) Extract() {
	details := GOnetstat.Tcp()
	for _, process := range details {
		engine.AddIP(process.Ip)
		engine.AddPort(uint16(process.ForeignPort))
	}
}

func init() {
	log.Debugln("Adding NetstatExtractor Extractor")

	file, err := os.Open("/proc")
	if err != nil {
		return
	}
	file.Close()

	engine.AddExtractor(NetstatExtractor{})
}
