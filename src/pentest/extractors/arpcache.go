package extractors

import (
	"github.com/mostlygeek/arp"
	"pentest/engine"
)

type ArpCacheExtractor struct{}

func (e ArpCacheExtractor) Extract() {
	engine.Logger.Debugf("Extracting targets from arp cache")

	details := arp.Table()
	for ip := range details {
		engine.AddIP(ip, e)
	}
}

func (e ArpCacheExtractor) Summary() {
	engine.Logger.Infof("IPs extracted using %T:", e)
	for _, ip := range engine.GetIPsByOrigin(e) {
		engine.Logger.Infof("    %s", ip)
	}
}

func init() {
	engine.Logger.Debugf("Adding ArpCacheExtractor Extractor")

	engine.AddExtractor(ArpCacheExtractor{})
}
